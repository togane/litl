wp.customize.controlConstructor["shapla-background"]=wp.customize.Control.extend({ready:function(){"use strict";this.initKirkiControl()},initKirkiControl:function(){var o=this,e=o.setting._value,t=o.container.find(".shapla-color-control");(_.isUndefined(e["background-image"])||""===e["background-image"])&&(o.container.find(".background-wrapper > .background-repeat").hide(),o.container.find(".background-wrapper > .background-position").hide(),o.container.find(".background-wrapper > .background-size").hide(),o.container.find(".background-wrapper > .background-attachment").hide()),t.wpColorPicker({change:function(){setTimeout(function(){o.saveValue("background-color",t.val())},100)}}),o.container.on("change",".background-repeat select",function(){o.saveValue("background-repeat",jQuery(this).val())}),o.container.on("change click",".background-size input",function(){o.saveValue("background-size",jQuery(this).val())}),o.container.on("change",".background-position select",function(){o.saveValue("background-position",jQuery(this).val())}),o.container.on("change click",".background-attachment input",function(){o.saveValue("background-attachment",jQuery(this).val())}),o.container.on("click",".background-image-upload-button",function(e){var r=wp.media({multiple:!1}).open().on("select",function(){var e,t,n,a=r.state().get("selection").first(),i=a.toJSON().sizes.full.url;_.isUndefined(a.toJSON().sizes.medium)?_.isUndefined(a.toJSON().sizes.thumbnail)||(i=a.toJSON().sizes.thumbnail.url):i=a.toJSON().sizes.medium.url,e=a.toJSON().sizes.full.url,a.toJSON().id,a.toJSON().width,a.toJSON().height,""!==e&&o.container.find(".background-wrapper > .background-repeat, .background-wrapper > .background-position, .background-wrapper > .background-size, .background-wrapper > .background-attachment").show(),o.saveValue("background-image",e),t=o.container.find(".placeholder, .thumbnail"),n=o.container.find(".background-image-upload-remove-button"),t.length&&t.removeClass().addClass("thumbnail thumbnail-image").html('<img src="'+i+'" alt="" />'),n.length&&n.show()});e.preventDefault()}),o.container.on("click",".background-image-upload-remove-button",function(e){var t,n;e.preventDefault(),o.saveValue("background-image",""),t=o.container.find(".placeholder, .thumbnail"),n=o.container.find(".background-image-upload-remove-button"),o.container.find(".background-wrapper > .background-repeat").hide(),o.container.find(".background-wrapper > .background-position").hide(),o.container.find(".background-wrapper > .background-size").hide(),o.container.find(".background-wrapper > .background-attachment").hide(),t.length&&t.removeClass().addClass("placeholder").html("No file selected"),n.length&&n.hide()})},saveValue:function(e,t){var n=this,a=jQuery("#customize-control-"+n.id.replace("[","-").replace("]","")+" .background-hidden-value"),i=n.setting._value;i[e]=t,jQuery(a).attr("value",JSON.stringify(i)).trigger("change"),n.setting.set(i)}}),wp.customize.controlConstructor["shapla-color"]=wp.customize.Control.extend({ready:function(){"use strict";var n=this,a=this.container.find(".shapla-color-control");void 0!==n.params.choices&&a.wpColorPicker(n.params.choices),a.wpColorPicker({change:function(e,t){setTimeout(function(){n.setting.set(a.val())},100)}})}}),wp.customize.controlConstructor["shapla-radio-buttonset"]=wp.customize.Control.extend({ready:function(){"use strict";var e=this;this.container.on("click","input",function(){e.setting.set(jQuery(this).val())})}}),wp.customize.controlConstructor["shapla-radio-image"]=wp.customize.Control.extend({ready:function(){"use strict";var e=this;this.container.on("click","input",function(){e.setting.set(jQuery(this).val())})}}),wp.customize.controlConstructor["shapla-slider"]=wp.customize.Control.extend({ready:function(){"use strict";var e,t,n,a,i=this;jQuery("input[type=range]").on("mousedown",function(){e=jQuery(this).attr("value"),jQuery(this).mousemove(function(){e=jQuery(this).attr("value"),jQuery(this).closest("label").find(".shapla_range_value .value").text(e)})}),jQuery(".shapla-slider-reset").click(function(){t=jQuery(this).closest("label").find("input"),n=t.data("reset_value"),t.val(n),t.change(),jQuery(this).closest("label").find(".shapla_range_value .value").text(n)}),a="postMessage"===i.setting.transport?"mousemove change":"change",this.container.on(a,"input",function(){i.setting.set(jQuery(this).val())})}}),wp.customize.controlConstructor["shapla-toggle"]=wp.customize.Control.extend({ready:function(){"use strict";var e=this,t=e.setting._value;this.container.on("change","input",function(){t=!!jQuery(this).is(":checked"),e.setting.set(t)})}}),wp.customize.controlConstructor["shapla-typography"]=wp.customize.Control.extend({ready:function(){"use strict";var e,t=this,n=t.setting._value;t.renderFontSelector(),t.renderBackupFontSelector(),t.renderVariantSelector(),t.params.default["font-size"]&&this.container.on("change keyup paste",".font-size input",function(){t.saveValue("font-size",jQuery(this).val())}),t.params.default["line-height"]&&this.container.on("change keyup paste",".line-height input",function(){t.saveValue("line-height",jQuery(this).val())}),t.params.default["margin-top"]&&this.container.on("change keyup paste",".margin-top input",function(){t.saveValue("margin-top",jQuery(this).val())}),t.params.default["margin-bottom"]&&this.container.on("change keyup paste",".margin-bottom input",function(){t.saveValue("margin-bottom",jQuery(this).val())}),t.params.default["letter-spacing"]&&(n["letter-spacing"]=jQuery.isNumeric(n["letter-spacing"])?n["letter-spacing"]+"px":n["letter-spacing"],this.container.on("change keyup paste",".letter-spacing input",function(){n["letter-spacing"]=jQuery.isNumeric(jQuery(this).val())?jQuery(this).val()+"px":jQuery(this).val(),t.saveValue("letter-spacing",n["letter-spacing"])})),t.params.default["word-spacing"]&&this.container.on("change keyup paste",".word-spacing input",function(){t.saveValue("word-spacing",jQuery(this).val())}),t.params.default["text-align"]&&this.container.on("change",".text-align input",function(){t.saveValue("text-align",jQuery(this).val())}),t.params.default["text-transform"]&&jQuery(t.selector+" .text-transform select").select2().on("change",function(){t.saveValue("text-transform",jQuery(this).val())}),t.params.default.color&&(e=this.container.find(".shapla-color-control")).wpColorPicker({change:function(){setTimeout(function(){t.saveValue("color",e.val())},100)}})},renderFontSelector:function(){var e,t,n=this,a=n.selector+" .font-family select",i=[],r=[],o=n.setting._value,s=n.getFonts();_.isUndefined(s.standard)||_.each(s.standard,function(e){i.push({id:e.family.replace(/&quot;/g,"&#39"),text:e.label})}),_.isUndefined(s.standard)||_.each(s.google,function(e){r.push({id:e.family,text:e.label})}),e=[{text:"Standard Fonts",children:i},{text:"Google Fonts",children:r}],t=jQuery(a).selectWoo({data:e}),o["font-family"]&&t.val(o["font-family"].replace(/'/g,'"')).trigger("change"),t.on("change",function(){n.saveValue("font-family",jQuery(this).val()),n.renderBackupFontSelector(),n.renderVariantSelector()})},renderBackupFontSelector:function(){var e,t=this,n=t.selector+" .font-backup select",a=[],i=t.setting._value,r=(i["font-family"],t.getFonts());(_.isUndefined(i["font-backup"])||null===i["font-backup"])&&(i["font-backup"]=""),jQuery(t.selector+" .font-backup").hide(),_.isUndefined(r.standard)||_.each(r.standard,function(e){a.push({id:e.family.replace(/&quot;/g,"&#39"),text:e.label})}),e=jQuery(n).selectWoo({data:a}),void 0!==i["font-backup"]&&e.val(i["font-backup"].replace(/'/g,'"')).trigger("change"),e.on("change",function(){t.saveValue("font-backup",jQuery(this).val())})},renderVariantSelector:function(){var e,t,n,a=this,i=a.setting._value,r=i["font-family"],o=a.selector+" .variant select",s=[],c=!1,u=a.getVariants(r);!1!==u?(jQuery(a.selector+" .variant").show(),_.each(u,function(e){i.variant===e.id&&(c=!0),s.push({id:e.id,text:e.label})}),c||(i.variant="regular"),jQuery(o).hasClass("select2-hidden-accessible")&&(jQuery(o).select2("destroy"),jQuery(o).empty()),(t=jQuery(o).select2({data:s})).val(i.variant).trigger("change"),t.on("change",function(){a.saveValue("variant",jQuery(this).val()),e=_.isString(i.variant)?i.variant.match(/\d/g):"400",e=_.isObject(e)?e.join(""):"400",n=-1!==i.variant.indexOf("italic")?"italic":"normal",a.saveValue("font-weight",e),a.saveValue("font-style",n)})):jQuery(a.selector+" .variant").hide()},renderSubsetSelector:function(){var e,t=this,n=t.getValue(),a=n["font-family"],i=t.getSubsets(a),r=t.selector+" .subsets select",o=[],s=n.subsets;!1!==i?(jQuery(t.selector+" .subsets").show(),_.each(i,function(t){_.isObject(s)&&-1===s.indexOf(t.id)&&(s=_.reject(s,function(e){return e===t.id})),o.push({id:t.id,text:t.label})})):jQuery(t.selector+" .subsets").hide(),jQuery(r).hasClass("select2-hidden-accessible")&&(jQuery(r).select2("destroy"),jQuery(r).empty()),(e=jQuery(r).select2({data:o})).val(s).trigger("change"),e.on("change",function(){t.saveValue("subsets",jQuery(this).val())})},getFonts:function(){return _.isUndefined(window["shaplaFonts"+this.id])?_.isUndefined(shaplaAllFonts)?{google:[],standard:[]}:shaplaAllFonts:window["shaplaFonts"+this.id]},getVariants:function(t){var e=this.getFonts(),n=!1;return _.each(e.standard,function(e){if(t&&e.family===t.replace(/'/g,'"'))return n=e.variants,e.variants}),_.each(e.google,function(e){if(e.family===t)return n=e.variants,e.variants}),n},getSubsets:function(t){var n=!1,e=this.getFonts();return _.each(e.google,function(e){e.family===t&&(n=e.subsets)}),n},getValue:function(){"use strict";var e=this.container.find(".typography-hidden-value"),t=jQuery(e).val();return JSON.parse(t)},saveValue:function(e,t){var n=this.container.find(".typography-hidden-value"),a=this.setting._value;a[e]=t,jQuery(n).attr("value",JSON.stringify(a)).trigger("change"),this.setting.set(a)}});